%% RabbitMQ Configuration for 96GB RAM System (Windows)
%% Optimized for 70 million message capacity
%% Place this file at: %APPDATA%\RabbitMQ\rabbitmq.config

[
  {rabbit, [
    %% ============================================
    %% MEMORY AND PERFORMANCE SETTINGS
    %% ============================================
    
    %% Use 50% of 96GB RAM (48GB) for message queues
    {vm_memory_high_watermark, {absolute, "48GB"}},
    {vm_memory_high_watermark_paging_ratio, 0.4},
    
    %% Allow massive message queues
    {vm_memory_calculation_strategy, allocated},
    
    %% Optimize for high-throughput scenarios
    {heartbeat, 60},
    {frame_max, 131072},
    {channel_max, 2047},
    
    %% ============================================
    %% DISK I/O OPTIMIZATION
    %% ============================================
    
    %% Optimize for disk I/O bound workloads (image processing)
    {disk_free_limit, {absolute, "5GB"}},
    
    %% Increase queue limits for massive workloads
    {queue_max_length, 50000000},
    {queue_max_length_bytes, 20000000000},
    
    %% Message store optimization
    {msg_store_file_size_limit, 16777216},
    {msg_store_credit_disc_bound, {4000, 2000}},
    
    %% Queue index optimization
    {queue_index_embed_msgs_below, 4096},
    
    %% ============================================
    %% NETWORK AND CONNECTION OPTIMIZATION
    %% ============================================
    
    %% TCP settings for high-throughput
    {tcp_listen_options, [
      {backlog, 4096},
      {nodelay, true},
      {keepalive, true},
      {send_timeout, 30000},
      {send_timeout_close, true}
    ]},
    
    %% Connection pooling
    {connection_max, 1000},
    
    %% ============================================
    %% LOGGING AND MONITORING
    %% ============================================
    
    %% Performance monitoring
    {collect_statistics_interval, 60000}
  ]},
  
  %% ============================================
  %% PLUGIN CONFIGURATION
  %% ============================================
  
  {rabbitmq_management, [
    {listener, [
      {port, 15672},
      {ip, "0.0.0.0"}
    ]}
  ]},
  
  %% ============================================
  %% ADVANCED PERFORMANCE TUNING
  %% ============================================
  
  {kernel, [
    %% Optimize for high message volumes
    {hipe_compile, true},
    {cluster_partition_handling, autoheal},
    
    %% Reduce garbage collection overhead
    {garbage_collection, [
      {min_heap_size, 134217728},
      {min_bin_vheap_size, 134217728}
    ]},
    
    %% Optimize for Windows
    {os_mon, [
      {enabled, true}
    ]}
  ]}
].
